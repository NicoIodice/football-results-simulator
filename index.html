<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Critical Cup 2025: Solidarity Football Tournament</title>
    <link rel="icon" type="image/x-icon" href="./assets/favicon.png">
    <link rel="apple-touch-icon" href="./assets/favicon-app.png">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Critical Cup 2025</h1>
            <p>Solidarity Football Tournament</p>
            <!-- Floating action buttons for settings and dark mode (mobile-friendly) -->
            <div class="fab-vertical-stack">
                <button id="dark-mode-toggle" class="dark-mode-toggle" onclick="toggleDarkMode()" title="Toggle Dark Mode">
                    <span class="dark-mode-icon">üåô</span>
                </button>
                <button id="settings-toggle" class="settings-toggle" onclick="showConfigModal()" title="Settings">
                    <span class="settings-icon">‚öôÔ∏è</span>
                </button>
            </div>
        </header>

        <!-- Config Modal -->
        <div id="configModal" class="modal config-modal" style="display:none;">
            <div class="modal-content config-modal-content">
                <div class="modal-header config-modal-header">
                    <h3>Configuration Settings</h3>
                    <span class="close-modal" onclick="hideConfigModal()">&times;</span>
                </div>
                <div class="config-modal-main">
                    <aside class="config-categories-panel" id="config-categories-panel">
                        <!-- Categories will be rendered here by JS -->
                    </aside>
                    <section class="config-fields-panel" id="config-fields-panel">
                        <!-- Fields for selected category will be rendered here by JS -->
                    </section>
                </div>
                <div class="modal-actions config-modal-actions">
                    <button type="button" class="btn-primary" id="config-save-btn" disabled onclick="saveConfig()">Save</button>
                </div>
            </div>
        </div>

        <nav class="tabs">
            <button class="tab-button active" onclick="showTab('overview')">Overview</button>
            <button class="tab-button" onclick="showTab('teams')">Teams</button>
            <button class="tab-button" onclick="showTab('fixtures')">Fixtures</button>
            <button class="tab-button" onclick="showTab('forecast')">Forecast</button>
            <button class="tab-button" onclick="showTab('simulator')">Simulator</button>
        </nav>

        <main>
            <!-- Overview Tab (formerly Standings) -->
            <div id="overview" class="tab-content active">
                <h2>Championship Overview</h2>
                
                <!-- Sub-tabs for Overview -->
                <div class="sub-tabs">
                    <button class="sub-tab-button active" onclick="showStandingsSubTab('league-standings')">League Standings</button>
                    <button class="sub-tab-button" onclick="showStandingsSubTab('knockout-stage')">Knockout</button>
                    <button class="sub-tab-button" onclick="showStandingsSubTab('statistics')">Statistics</button>
                </div>
                
                <!-- League Standings Sub-tab -->
                <div id="league-standings" class="sub-tab-content active">
                    <div class="group-selector">
                        <label for="selected-group">Group:</label>
                        <div class="group-selector-container">
                            <select id="selected-group" onchange="updateStandingsForGroup()">
                                <!-- Groups will be populated by JavaScript -->
                            </select>
                            <div id="group-status-indicator" class="group-status-indicator">
                                <!-- Status icon and message will be populated dynamically -->
                            </div>
                        </div>
                    </div>
                    <div class="table-container">
                        <table id="standings-table">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Team</th>
                                    <th>Matches</th>
                                    <th>W-L-D</th>
                                    <th title="Total goals scored minus goals given up">Goals Diff (TB1)</th>
                                    <th title="Number of total goals scored per team">Total Goals (TB2)</th>
                                    <th title="The highest number of points obtained by the tied teams in the matches they played against each other">Head-to-Head (TB3)</th>
                                    <th>Match History</th>
                                    <th>Points</th>
                                </tr>
                            </thead>
                            <tbody id="standings-body">
                                <!-- Standings will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Knockout Stage Sub-tab -->
                <div id="knockout-stage" class="sub-tab-content">
                    <div class="knockout-header">
                        <h3>üèÜ Semi-Finals & Finals</h3>
                        <p class="knockout-date" id="knockout-date"><!-- Date will be loaded from config --></p>
                    </div>
                    
                    <!-- Knockout Stage Status Disclaimer -->
                    <div id="knockout-disclaimer" class="knockout-disclaimer">
                        <!-- Will be populated dynamically -->
                    </div>
                    
                    <div class="knockout-bracket">
                        <!-- Semi-Finals -->
                        <div class="knockout-round semi-finals">
                            <h4>Semi-Finals</h4>
                            <div class="matches-container">
                                <div class="knockout-match">
                                    <div class="match-header">
                                        <div class="match-label">Semi-Final 1</div>
                                        <div class="match-time" id="semi1-time"></div>
                                        <div class="match-venue" id="semi1-venue"></div>
                                    </div>
                                    <div class="match-participants">
                                        <div class="participant">
                                            <div id="group-b-winner" class="team-box">
                                                <span class="team-name">TBD</span>
                                            </div>
                                            <div class="team-label" id="semi1-home-label">Winner of Group B</div>
                                        </div>
                                        <div class="vs-section">
                                            <div class="vs-text">VS</div>
                                        </div>
                                        <div class="participant">
                                            <div id="group-d-winner" class="team-box">
                                                <span class="team-name">TBD</span>
                                            </div>
                                            <div class="team-label" id="semi1-away-label">Winner of Group D</div>
                                        </div>
                                    </div>
                                    <div class="match-controls">
                                        <div class="score-display" id="semi1-score"> - </div>
                                        <button class="add-result-btn" onclick="addKnockoutResult('semi1')" id="semi1-add-btn">
                                            <span class="plus-icon">+</span>
                                        </button>
                                        <button class="edit-result-btn" onclick="editKnockoutResult('semi1')" id="semi1-edit-btn" style="display: none;">
                                            Edit
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="knockout-match">
                                    <div class="match-header">
                                        <div class="match-label">Semi-Final 2</div>
                                        <div class="match-time" id="semi2-time"></div>
                                        <div class="match-venue" id="semi2-venue"></div>
                                    </div>
                                    <div class="match-participants">
                                        <div class="participant">
                                            <div id="group-a-winner" class="team-box">
                                                <span class="team-name">TBD</span>
                                            </div>
                                            <div class="team-label" id="semi2-home-label">Winner of Group A</div>
                                        </div>
                                        <div class="vs-section">
                                            <div class="vs-text">VS</div>
                                        </div>
                                        <div class="participant">
                                            <div id="group-c-winner" class="team-box">
                                                <span class="team-name">TBD</span>
                                            </div>
                                            <div class="team-label" id="semi2-away-label">Winner of Group C</div>
                                        </div>
                                    </div>
                                    <div class="match-controls">
                                        <div class="score-display" id="semi2-score"> - </div>
                                        <button class="add-result-btn" onclick="addKnockoutResult('semi2')" id="semi2-add-btn">
                                            <span class="plus-icon">+</span>
                                        </button>
                                        <button class="edit-result-btn" onclick="editKnockoutResult('semi2')" id="semi2-edit-btn" style="display: none;">
                                            Edit
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Finals -->
                        <div class="knockout-round final">
                            <h4>Final</h4>
                            <div class="matches-container">
                                <div class="knockout-match final-match">
                                    <div class="match-header">
                                        <div class="match-label">Championship Final</div>
                                        <div class="match-time" id="final-time"></div>
                                        <div class="match-venue" id="final-venue"></div>
                                    </div>
                                    <div class="match-participants">
                                        <div class="participant">
                                            <div id="semifinal-1-winner" class="team-box">
                                                <span class="team-name">TBD</span>
                                            </div>
                                            <div class="team-label">Winner of Semi-Final 1</div>
                                        </div>
                                        <div class="vs-section">
                                            <div class="vs-text">VS</div>
                                        </div>
                                        <div class="participant">
                                            <div id="semifinal-2-winner" class="team-box">
                                                <span class="team-name">TBD</span>
                                            </div>
                                            <div class="team-label">Winner of Semi-Final 2</div>
                                        </div>
                                    </div>
                                    <div class="match-controls">
                                        <div class="score-display" id="final-score"> - </div>
                                        <button class="add-result-btn" onclick="addKnockoutResult('final')" id="final-add-btn">
                                            <span class="plus-icon">+</span>
                                        </button>
                                        <button class="edit-result-btn" onclick="editKnockoutResult('final')" id="final-edit-btn" style="display: none;">
                                            Edit
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 3rd/4th Place Playoff -->
                        <div class="knockout-round third-place">
                            <h4>3rd/4th Place Playoff</h4>
                            <div class="matches-container">
                                <div class="knockout-match">
                                    <div class="match-header">
                                        <div class="match-label">3rd Place Match</div>
                                        <div class="match-time" id="third-time"></div>
                                        <div class="match-venue" id="third-venue"></div>
                                    </div>
                                    <div class="match-participants">
                                        <div class="participant">
                                            <div id="semifinal-1-loser" class="team-box">
                                                <span class="team-name">TBD</span>
                                            </div>
                                            <div class="team-label">Loser of Semi-Final 1</div>
                                        </div>
                                        <div class="vs-section">
                                            <div class="vs-text">VS</div>
                                        </div>
                                        <div class="participant">
                                            <div id="semifinal-2-loser" class="team-box">
                                                <span class="team-name">TBD</span>
                                            </div>
                                            <div class="team-label">Loser of Semi-Final 2</div>
                                        </div>
                                    </div>
                                    <div class="match-controls">
                                        <div class="score-display" id="third-score"> - </div>
                                        <button class="add-result-btn" onclick="addKnockoutResult('third')" id="third-add-btn">
                                            <span class="plus-icon">+</span>
                                        </button>
                                        <button class="edit-result-btn" onclick="editKnockoutResult('third')" id="third-edit-btn" style="display: none;">
                                            Edit
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Statistics Sub-tab -->
                <div id="statistics" class="sub-tab-content">
                    <!-- Statistics Controls -->
                    <div class="statistics-controls">
                        <div class="control-row">
                            <div class="group-selector">
                                <label for="statistics-group-select">Group:</label>
                                <select id="statistics-group-select" onchange="updateStatisticsForGroup()">
                                    <!-- Groups will be populated by JavaScript -->
                                </select>
                            </div>
                            <div class="checkbox-control">
                                <label for="show-all-statistics">
                                    <input type="checkbox" id="show-all-statistics" onchange="toggleAllStatistics()">
                                    Show All Groups
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Team Performance Analysis Section -->
                    <div class="statistics-section">
                        <div class="statistics-header">
                            üìä Team Performance Analysis
                        </div>
                        <div id="team-performance-content" class="statistics-content">
                            <!-- Team Performance Analysis will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Statistical Insights Section -->
                    <div class="statistics-section">
                        <div class="statistics-header">
                            üìà Statistical Insights
                        </div>
                        <div id="statistical-insights-content" class="statistics-content">
                            <!-- Statistical Insights will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Top Scorers Section -->
                    <div class="statistics-section">
                        <div class="statistics-header">
                            ‚öΩ Top Scorers
                        </div>
                        <div class="topscorers-controls">
                            <div class="control-row">
                                <div class="filter-selector">
                                    <label for="topscorers-filter">Filter by:</label>
                                    <select id="topscorers-filter" onchange="updateTopScorersFilter()">
                                        <option value="group">Group</option>
                                        <option value="team">Team</option>
                                    </select>
                                </div>
                                <div class="group-selector-inline" id="topscorers-group-selector">
                                    <label for="topscorers-group-select">Group:</label>
                                    <select id="topscorers-group-select" onchange="updateTopScorers()">
                                        <!-- Groups will be populated by JavaScript -->
                                    </select>
                                </div>
                                <div class="team-selector-inline" id="topscorers-team-selector" style="display: none;">
                                    <label for="topscorers-team-select">Team:</label>
                                    <select id="topscorers-team-select" onchange="updateTopScorers()">
                                        <!-- Teams will be populated by JavaScript -->
                                    </select>
                                </div>
                                <div class="checkbox-control">
                                    <label for="show-all-topscorers">
                                        <input type="checkbox" id="show-all-topscorers" onchange="toggleAllTopScorers()">
                                        Show All Groups
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div id="topscorers-content" class="statistics-content">
                            <!-- Top Scorers will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Teams Tab -->
            <div id="teams" class="tab-content">
                <h2>Team Lineup & Squad</h2>
                <div class="teams-controls">
                    <div class="team-selector">
                        <label for="selected-team-lineup">Team:</label>
                        <select id="selected-team-lineup" onchange="updateTeamLineup()">
                            <!-- Teams will be populated by JavaScript -->
                        </select>
                    </div>
                    
                    <div class="tactics-selector">
                        <label for="selected-tactics">Formation:</label>
                        <select id="selected-tactics" onchange="updateFormation()">
                            <!-- Tactics will be populated by JavaScript -->
                        </select>
                    </div>
                </div>
                
                <div id="team-lineup-content">
                    <div class="football-field">
                        <!-- Goalkeeper Area -->
                        <div class="goalkeeper-area">
                            <div class="goal">
                                <div class="goalkeeper-position">
                                    <div id="goalkeeper" class="player-icon goalkeeper">
                                        <span class="player-number">1</span>
                                    </div>
                                    <div id="goalkeeper-name" class="player-name">Goalkeeper</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Field Players Area -->
                        <div class="field-players">
                            <div class="formation-line defense" data-line="defense">
                                <div class="line-slot" data-slot="1"></div>
                                <div class="line-slot" data-slot="2"></div>
                                <div class="line-slot" data-slot="3"></div>
                                <div class="line-slot" data-slot="4"></div>
                                <div class="line-slot" data-slot="5"></div>
                            </div>

                            <div class="formation-line midfield" data-line="midfield">
                                <div class="line-slot" data-slot="1"></div>
                                <div class="line-slot" data-slot="2"></div>
                                <div class="line-slot" data-slot="3"></div>
                                <div class="line-slot" data-slot="4"></div>
                                <div class="line-slot" data-slot="5"></div>
                            </div>

                            <div class="formation-line attack" data-line="attack">
                                <div class="line-slot" data-slot="1"></div>
                                <div class="line-slot" data-slot="2"></div>
                                <div class="line-slot" data-slot="3"></div>
                                <div class="line-slot" data-slot="4"></div>
                                <div class="line-slot" data-slot="5"></div>
                            </div>
                        </div>
                        
                        <!-- Center Circle -->
                        <div class="center-circle"></div>
                        
                        <!-- Field Lines -->
                        <div class="field-lines">
                            <div class="enemy-goal-area"></div>
                            <div class="penalty-spot enemy-penalty"></div>
                            <div class="enemy-penalty-arc"></div>
                            <div class="penalty-area"></div>
                            <div class="penalty-spot player-penalty"></div>
                            <div class="goal-area"></div>
                        </div>
                    </div>
                    
                    <!-- Bench Area -->
                    <div class="bench-area">
                        <h3>ü™ë Bench</h3>
                        <div id="bench-players" class="bench-players">
                            <!-- Bench players will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Fixtures Tab -->
            <div id="fixtures" class="tab-content">
                <h2>Fixtures & Results</h2>
                
                <!-- Today's Games Header Card -->
                <div id="todays-games-header" class="todays-games-card" style="display: none;">
                    <h3>üèÜ Today's Matches</h3>
                    <div id="todays-games-list"></div>
                </div>
                
                <!-- Fixtures Controls -->
                <div class="fixtures-controls">
                    <div class="control-row">
                        <div class="group-selector">
                            <label for="fixtures-group-select">Group:</label>
                            <select id="fixtures-group-select" onchange="updateFixturesForGroup()">
                                <!-- Groups will be populated by JavaScript -->
                            </select>
                        </div>
                        <div class="checkbox-control">
                            <label for="show-all-fixtures">
                                <input type="checkbox" id="show-all-fixtures" onchange="toggleAllFixtures()">
                                Show All Fixtures
                            </label>
                        </div>
                    </div>
                </div>
                
                <div id="fixtures-content">
                    <!-- Fixtures will be populated by JavaScript -->
                </div>
            </div>

            <!-- Simulator Tab -->
            <div id="simulator" class="tab-content">
                <h2>Championship Simulator</h2>
                <div class="simulator-controls">
                    <div class="team-selector">
                        <label for="selected-team">Team to Analyze:</label>
                        <select id="selected-team" onchange="updateSimulation()">
                            <!-- Teams will be populated by JavaScript -->
                        </select>
                    </div>
                </div>

                <div id="simulation-results">
                    <!-- Simulation results will be populated by JavaScript -->
                </div>
            </div>

            <!-- Forecast Tab -->
            <div id="forecast" class="tab-content">
                <h2>üîÆ Championship Forecast & Predictions</h2>
                <div class="forecast-description">
                    <p>AI-powered predictions based on team performance, form, consistency, and statistical analysis.</p>
                </div>
                
                <!-- Forecast Controls -->
                <div class="forecast-controls">
                    <div class="group-selector">
                        <label for="forecast-group-select">Group:</label>
                        <select id="forecast-group-select" onchange="updateForecastForGroup()">
                            <!-- Groups will be populated by JavaScript -->
                        </select>
                    </div>
                </div>
                
                <div id="forecast-content">
                    <!-- Forecast content will be populated by JavaScript -->
                </div>
            </div>

        </main>
    </div>

    <!-- Add Result Modal -->
    <div id="addResultModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Match Result</h3>
                <span class="close-modal" onclick="hideAddResultModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="match-info">
                    <p><strong>Match:</strong> <span id="modal-teams"></span></p>
                    <p><strong>Date & Time:</strong> <span id="modal-datetime"></span></p>
                </div>
                <form id="addResultForm" onsubmit="submitResult(event)">
                    <div class="score-inputs">
                        <div class="team-score">
                            <label for="homeScore" id="homeTeamLabel"></label>
                            <input type="number" id="homeScore" min="0" max="99" required>
                        </div>
                        <div class="vs-separator">VS</div>
                        <div class="team-score">
                            <label for="awayScore" id="awayTeamLabel"></label>
                            <input type="number" id="awayScore" min="0" max="99" required>
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" onclick="hideAddResultModal()">Cancel</button>
                        <button type="submit" class="btn-primary">Add Result</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- Loading Mask for OpenAI SDK -->
    <div id="openai-loading-mask" class="loading-mask hide">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <div class="loading-text">
                <h3>ü§ñ Initializing AI Engine</h3>
                <p>Loading OpenAI SDK for advanced analysis...</p>
                <div class="loading-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="loading-progress-fill"></div>
                    </div>
                    <span class="progress-text" id="loading-progress-text">0%</span>
                </div>
            </div>
        </div>
    </div>

    <!-- OpenAI SDK -->
    <!--<script src="https://cdn.jsdelivr.net/npm/openai@4.0.0/dist/openai.min.js"></script>-->
    <script src="script.js"></script>
</body>
</html>